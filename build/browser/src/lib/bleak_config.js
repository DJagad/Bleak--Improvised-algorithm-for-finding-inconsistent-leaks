var DEFAULT_CONFIG = {
    iterations: 8,
    rankingEvaluationIterations: 10,
    rankingEvaluationRuns: 5,
    url: "http://localhost:8080/",
    fixedLeaks: [],
    fixMap: {},
    login: [],
    setup: [],
    loop: [],
    postCheckSleep: 1000,
    postNextSleep: 0,
    postLoginSleep: 5000,
    timeout: 10 * 60 * 1000,
    rewrite: function (url, type, data, fixes) { return data; }
};
var DEFAULT_CONFIG_STRING = JSON.stringify(DEFAULT_CONFIG);
function getConfigFromSource(configSource) {
    var m = { exports: {} };
    // CommonJS emulation
    try {
        var exportsObj = new Function('exports', 'module', configSource + "\nreturn module.exports ? module.exports : exports;")(m.exports, m);
        return Object.assign({}, DEFAULT_CONFIG, exportsObj);
    }
    catch (e) {
        throw new Error("Unable to run configuration file: " + e);
    }
}
function checkFunction(prop, data) {
    if (typeof (data) !== 'function') {
        throw new Error("config." + prop + " is not a function!");
    }
}
function checkStep(type, i, data) {
    checkFunction(type + "[" + i + "].check", data.check);
    checkFunction(type + "[" + i + "].next", data.next);
}
function checkNumber(prop, data) {
    if (typeof (data) !== 'number') {
        throw new Error("config." + prop + " is not a number!");
    }
}
function checkString(prop, data) {
    if (typeof (data) !== 'string') {
        throw new Error("config." + prop + " is not a string!");
    }
}
var BLeakConfig = /** @class */ (function () {
    function BLeakConfig(raw, _configSource) {
        this._configSource = _configSource;
        this.url = raw.url;
        this.loop = raw.loop;
        this.iterations = raw.iterations;
        this.rankingEvaluationIterations = raw.rankingEvaluationIterations;
        this.rankingEvaluationRuns = raw.rankingEvaluationRuns;
        this.fixedLeaks = raw.fixedLeaks;
        this.fixMap = raw.fixMap;
        this.login = raw.login;
        this.setup = raw.setup;
        this.timeout = raw.timeout;
        this.rewrite = raw.rewrite;
        this.postCheckSleep = raw.postCheckSleep;
        this.postNextSleep = raw.postNextSleep;
        this.postLoginSleep = raw.postLoginSleep;
    }
    BLeakConfig.FromSource = function (configSource) {
        var raw = getConfigFromSource(configSource);
        // Sanity check types.
        checkString('url', raw.url);
        raw.loop.forEach(function (s, i) { return checkStep('loop', i, s); });
        checkNumber('iterations', raw.iterations);
        checkNumber('rankingEvaluationIterations', raw.rankingEvaluationIterations);
        checkNumber('rankingEvaluationRuns', raw.rankingEvaluationRuns);
        raw.fixedLeaks.forEach(function (n, i) { return checkNumber("fixedLeaks[" + i + "]", n); });
        raw.login.forEach(function (s, i) { return checkStep('login', i, s); });
        raw.setup.forEach(function (s, i) { return checkStep('setup', i, s); });
        checkNumber('timeout', raw.timeout);
        checkFunction('rewrite', raw.rewrite);
        checkNumber('postCheckSleep', raw.postCheckSleep);
        checkNumber('postNextSleep', raw.postNextSleep);
        checkNumber('postLoginSleep', raw.postLoginSleep);
        return new BLeakConfig(raw, configSource);
    };
    BLeakConfig.prototype.getBrowserInjection = function () {
        // CommonJS emulation
        return "(function() {\n  var module = { exports: {} };\n  var exports = module.exports;\n  " + this._configSource + "\n  window.BLeakConfig = Object.assign({}, " + DEFAULT_CONFIG_STRING + ", module.exports ? module.exports : exports);\n})();";
    };
    return BLeakConfig;
}());
export default BLeakConfig;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmxlYWtfY29uZmlnLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi9ibGVha19jb25maWcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsSUFBTSxjQUFjLEdBQWlCO0lBQ25DLFVBQVUsRUFBRSxDQUFDO0lBQ2IsMkJBQTJCLEVBQUUsRUFBRTtJQUMvQixxQkFBcUIsRUFBRSxDQUFDO0lBQ3hCLEdBQUcsRUFBRSx3QkFBd0I7SUFDN0IsVUFBVSxFQUFFLEVBQUU7SUFDZCxNQUFNLEVBQUUsRUFBRTtJQUNWLEtBQUssRUFBRSxFQUFFO0lBQ1QsS0FBSyxFQUFFLEVBQUU7SUFDVCxJQUFJLEVBQUUsRUFBRTtJQUNSLGNBQWMsRUFBRSxJQUFJO0lBQ3BCLGFBQWEsRUFBRSxDQUFDO0lBQ2hCLGNBQWMsRUFBRSxJQUFJO0lBQ3BCLE9BQU8sRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUk7SUFDdkIsT0FBTyxFQUFFLFVBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxJQUFLLE9BQUEsSUFBSSxFQUFKLENBQUk7Q0FDMUMsQ0FBQztBQUNGLElBQU0scUJBQXFCLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsQ0FBQztBQUU3RCw2QkFBNkIsWUFBb0I7SUFDL0MsSUFBTSxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLENBQUM7SUFDMUIscUJBQXFCO0lBQ3JCLElBQUksQ0FBQztRQUNILElBQU0sVUFBVSxHQUFHLElBQUksUUFBUSxDQUFDLFNBQVMsRUFBRSxRQUFRLEVBQUssWUFBWSx3REFBcUQsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDekksTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLGNBQWMsRUFBRSxVQUFVLENBQUMsQ0FBQztJQUN2RCxDQUFDO0lBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNYLE1BQU0sSUFBSSxLQUFLLENBQUMsdUNBQXFDLENBQUcsQ0FBQyxDQUFDO0lBQzVELENBQUM7QUFDSCxDQUFDO0FBRUQsdUJBQXVCLElBQVksRUFBRSxJQUFjO0lBQ2pELEVBQUUsQ0FBQyxDQUFDLE9BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDO1FBQ2hDLE1BQU0sSUFBSSxLQUFLLENBQUMsWUFBVSxJQUFJLHdCQUFxQixDQUFDLENBQUM7SUFDdkQsQ0FBQztBQUNILENBQUM7QUFFRCxtQkFBbUIsSUFBYyxFQUFFLENBQVMsRUFBRSxJQUFVO0lBQ3RELGFBQWEsQ0FBSSxJQUFJLFNBQUksQ0FBQyxZQUFTLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2pELGFBQWEsQ0FBSSxJQUFJLFNBQUksQ0FBQyxXQUFRLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2pELENBQUM7QUFFRCxxQkFBcUIsSUFBWSxFQUFFLElBQVk7SUFDN0MsRUFBRSxDQUFDLENBQUMsT0FBTSxDQUFDLElBQUksQ0FBQyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUM7UUFDOUIsTUFBTSxJQUFJLEtBQUssQ0FBQyxZQUFVLElBQUksc0JBQW1CLENBQUMsQ0FBQztJQUNyRCxDQUFDO0FBQ0gsQ0FBQztBQUVELHFCQUFxQixJQUFZLEVBQUUsSUFBWTtJQUM3QyxFQUFFLENBQUMsQ0FBQyxPQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQztRQUM5QixNQUFNLElBQUksS0FBSyxDQUFDLFlBQVUsSUFBSSxzQkFBbUIsQ0FBQyxDQUFDO0lBQ3JELENBQUM7QUFDSCxDQUFDO0FBRUQ7SUFtQ0UscUJBQW9CLEdBQWlCLEVBQW1CLGFBQXFCO1FBQXJCLGtCQUFhLEdBQWIsYUFBYSxDQUFRO1FBQzNFLElBQUksQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQztRQUNuQixJQUFJLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUM7UUFDckIsSUFBSSxDQUFDLFVBQVUsR0FBRyxHQUFHLENBQUMsVUFBVSxDQUFDO1FBQ2pDLElBQUksQ0FBQywyQkFBMkIsR0FBRyxHQUFHLENBQUMsMkJBQTJCLENBQUM7UUFDbkUsSUFBSSxDQUFDLHFCQUFxQixHQUFHLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQztRQUN2RCxJQUFJLENBQUMsVUFBVSxHQUFHLEdBQUcsQ0FBQyxVQUFVLENBQUM7UUFDakMsSUFBSSxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQztRQUN2QixJQUFJLENBQUMsS0FBSyxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUM7UUFDdkIsSUFBSSxDQUFDLE9BQU8sR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDO1FBQzNCLElBQUksQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQztRQUMzQixJQUFJLENBQUMsY0FBYyxHQUFHLEdBQUcsQ0FBQyxjQUFjLENBQUM7UUFDekMsSUFBSSxDQUFDLGFBQWEsR0FBRyxHQUFHLENBQUMsYUFBYSxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxjQUFjLEdBQUcsR0FBRyxDQUFDLGNBQWMsQ0FBQztJQUMzQyxDQUFDO0lBakRhLHNCQUFVLEdBQXhCLFVBQXlCLFlBQW9CO1FBQzNDLElBQU0sR0FBRyxHQUFHLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQzlDLHNCQUFzQjtRQUN0QixXQUFXLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUM1QixHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFDLENBQUMsRUFBRSxDQUFDLElBQUssT0FBQSxTQUFTLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBdkIsQ0FBdUIsQ0FBQyxDQUFDO1FBQ3BELFdBQVcsQ0FBQyxZQUFZLEVBQUUsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzFDLFdBQVcsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLENBQUMsMkJBQTJCLENBQUMsQ0FBQztRQUM1RSxXQUFXLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFDaEUsR0FBRyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsVUFBQyxDQUFDLEVBQUUsQ0FBQyxJQUFLLE9BQUEsV0FBVyxDQUFDLGdCQUFjLENBQUMsTUFBRyxFQUFFLENBQUMsQ0FBQyxFQUFsQyxDQUFrQyxDQUFDLENBQUM7UUFDckUsR0FBRyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBQyxDQUFDLEVBQUUsQ0FBQyxJQUFLLE9BQUEsU0FBUyxDQUFDLE9BQU8sRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQXhCLENBQXdCLENBQUMsQ0FBQztRQUN0RCxHQUFHLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFDLENBQUMsRUFBRSxDQUFDLElBQUssT0FBQSxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBeEIsQ0FBd0IsQ0FBQyxDQUFDO1FBQ3RELFdBQVcsQ0FBQyxTQUFTLEVBQUUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3BDLGFBQWEsQ0FBQyxTQUFTLEVBQUUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3RDLFdBQVcsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDbEQsV0FBVyxDQUFDLGVBQWUsRUFBRSxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDaEQsV0FBVyxDQUFDLGdCQUFnQixFQUFFLEdBQUcsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUNsRCxNQUFNLENBQUMsSUFBSSxXQUFXLENBQUMsR0FBRyxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFrQ00seUNBQW1CLEdBQTFCO1FBQ0UscUJBQXFCO1FBQ3JCLE1BQU0sQ0FBQyx3RkFHUCxJQUFJLENBQUMsYUFBYSxtREFDcUIscUJBQXFCLHlEQUMxRCxDQUFDO0lBQ0wsQ0FBQztJQUNILGtCQUFDO0FBQUQsQ0FBQyxBQTdERCxJQTZEQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SUJMZWFrQ29uZmlnLCBTdGVwVHlwZSwgU3RlcH0gZnJvbSAnLi4vY29tbW9uL2ludGVyZmFjZXMnO1xuXG5jb25zdCBERUZBVUxUX0NPTkZJRzogSUJMZWFrQ29uZmlnID0ge1xuICBpdGVyYXRpb25zOiA4LFxuICByYW5raW5nRXZhbHVhdGlvbkl0ZXJhdGlvbnM6IDEwLFxuICByYW5raW5nRXZhbHVhdGlvblJ1bnM6IDUsXG4gIHVybDogXCJodHRwOi8vbG9jYWxob3N0OjgwODAvXCIsXG4gIGZpeGVkTGVha3M6IFtdLFxuICBmaXhNYXA6IHt9LFxuICBsb2dpbjogW10sXG4gIHNldHVwOiBbXSxcbiAgbG9vcDogW10sXG4gIHBvc3RDaGVja1NsZWVwOiAxMDAwLFxuICBwb3N0TmV4dFNsZWVwOiAwLFxuICBwb3N0TG9naW5TbGVlcDogNTAwMCxcbiAgdGltZW91dDogMTAgKiA2MCAqIDEwMDAsIC8vIDEwIG1pbnV0ZXNcbiAgcmV3cml0ZTogKHVybCwgdHlwZSwgZGF0YSwgZml4ZXMpID0+IGRhdGFcbn07XG5jb25zdCBERUZBVUxUX0NPTkZJR19TVFJJTkcgPSBKU09OLnN0cmluZ2lmeShERUZBVUxUX0NPTkZJRyk7XG5cbmZ1bmN0aW9uIGdldENvbmZpZ0Zyb21Tb3VyY2UoY29uZmlnU291cmNlOiBzdHJpbmcpOiBJQkxlYWtDb25maWcge1xuICBjb25zdCBtID0geyBleHBvcnRzOiB7fSB9O1xuICAvLyBDb21tb25KUyBlbXVsYXRpb25cbiAgdHJ5IHtcbiAgICBjb25zdCBleHBvcnRzT2JqID0gbmV3IEZ1bmN0aW9uKCdleHBvcnRzJywgJ21vZHVsZScsIGAke2NvbmZpZ1NvdXJjZX1cXG5yZXR1cm4gbW9kdWxlLmV4cG9ydHMgPyBtb2R1bGUuZXhwb3J0cyA6IGV4cG9ydHM7YCkobS5leHBvcnRzLCBtKTtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcsIGV4cG9ydHNPYmopO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gcnVuIGNvbmZpZ3VyYXRpb24gZmlsZTogJHtlfWApO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNoZWNrRnVuY3Rpb24ocHJvcDogc3RyaW5nLCBkYXRhOiBGdW5jdGlvbik6IHZvaWQge1xuICBpZiAodHlwZW9mKGRhdGEpICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBjb25maWcuJHtwcm9wfSBpcyBub3QgYSBmdW5jdGlvbiFgKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjaGVja1N0ZXAodHlwZTogU3RlcFR5cGUsIGk6IG51bWJlciwgZGF0YTogU3RlcCk6IHZvaWQge1xuICBjaGVja0Z1bmN0aW9uKGAke3R5cGV9WyR7aX1dLmNoZWNrYCwgZGF0YS5jaGVjayk7XG4gIGNoZWNrRnVuY3Rpb24oYCR7dHlwZX1bJHtpfV0ubmV4dGAsIGRhdGEubmV4dCk7XG59XG5cbmZ1bmN0aW9uIGNoZWNrTnVtYmVyKHByb3A6IHN0cmluZywgZGF0YTogbnVtYmVyKTogdm9pZCB7XG4gIGlmICh0eXBlb2YoZGF0YSkgIT09ICdudW1iZXInKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBjb25maWcuJHtwcm9wfSBpcyBub3QgYSBudW1iZXIhYCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY2hlY2tTdHJpbmcocHJvcDogc3RyaW5nLCBkYXRhOiBzdHJpbmcpOiB2b2lkIHtcbiAgaWYgKHR5cGVvZihkYXRhKSAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYGNvbmZpZy4ke3Byb3B9IGlzIG5vdCBhIHN0cmluZyFgKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCTGVha0NvbmZpZyBpbXBsZW1lbnRzIElCTGVha0NvbmZpZyB7XG4gIHB1YmxpYyBzdGF0aWMgRnJvbVNvdXJjZShjb25maWdTb3VyY2U6IHN0cmluZyk6IEJMZWFrQ29uZmlnIHtcbiAgICBjb25zdCByYXcgPSBnZXRDb25maWdGcm9tU291cmNlKGNvbmZpZ1NvdXJjZSk7XG4gICAgLy8gU2FuaXR5IGNoZWNrIHR5cGVzLlxuICAgIGNoZWNrU3RyaW5nKCd1cmwnLCByYXcudXJsKTtcbiAgICByYXcubG9vcC5mb3JFYWNoKChzLCBpKSA9PiBjaGVja1N0ZXAoJ2xvb3AnLCBpLCBzKSk7XG4gICAgY2hlY2tOdW1iZXIoJ2l0ZXJhdGlvbnMnLCByYXcuaXRlcmF0aW9ucyk7XG4gICAgY2hlY2tOdW1iZXIoJ3JhbmtpbmdFdmFsdWF0aW9uSXRlcmF0aW9ucycsIHJhdy5yYW5raW5nRXZhbHVhdGlvbkl0ZXJhdGlvbnMpO1xuICAgIGNoZWNrTnVtYmVyKCdyYW5raW5nRXZhbHVhdGlvblJ1bnMnLCByYXcucmFua2luZ0V2YWx1YXRpb25SdW5zKTtcbiAgICByYXcuZml4ZWRMZWFrcy5mb3JFYWNoKChuLCBpKSA9PiBjaGVja051bWJlcihgZml4ZWRMZWFrc1ske2l9XWAsIG4pKTtcbiAgICByYXcubG9naW4uZm9yRWFjaCgocywgaSkgPT4gY2hlY2tTdGVwKCdsb2dpbicsIGksIHMpKTtcbiAgICByYXcuc2V0dXAuZm9yRWFjaCgocywgaSkgPT4gY2hlY2tTdGVwKCdzZXR1cCcsIGksIHMpKTtcbiAgICBjaGVja051bWJlcigndGltZW91dCcsIHJhdy50aW1lb3V0KTtcbiAgICBjaGVja0Z1bmN0aW9uKCdyZXdyaXRlJywgcmF3LnJld3JpdGUpO1xuICAgIGNoZWNrTnVtYmVyKCdwb3N0Q2hlY2tTbGVlcCcsIHJhdy5wb3N0Q2hlY2tTbGVlcCk7XG4gICAgY2hlY2tOdW1iZXIoJ3Bvc3ROZXh0U2xlZXAnLCByYXcucG9zdE5leHRTbGVlcCk7XG4gICAgY2hlY2tOdW1iZXIoJ3Bvc3RMb2dpblNsZWVwJywgcmF3LnBvc3RMb2dpblNsZWVwKTtcbiAgICByZXR1cm4gbmV3IEJMZWFrQ29uZmlnKHJhdywgY29uZmlnU291cmNlKTtcbiAgfVxuXG4gIHB1YmxpYyByZWFkb25seSB1cmw6IHN0cmluZztcbiAgcHVibGljIHJlYWRvbmx5IGxvb3A6IFN0ZXBbXTtcbiAgcHVibGljIHJlYWRvbmx5IGl0ZXJhdGlvbnM6IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IHJhbmtpbmdFdmFsdWF0aW9uSXRlcmF0aW9uczogbnVtYmVyO1xuICBwdWJsaWMgcmVhZG9ubHkgcmFua2luZ0V2YWx1YXRpb25SdW5zOiBudW1iZXI7XG4gIHB1YmxpYyByZWFkb25seSBmaXhlZExlYWtzOiBudW1iZXJbXTtcbiAgcHVibGljIHJlYWRvbmx5IGZpeE1hcDoge1tsZWFrUm9vdDogc3RyaW5nXTogbnVtYmVyfTtcbiAgcHVibGljIHJlYWRvbmx5IGxvZ2luOiBTdGVwW107XG4gIHB1YmxpYyByZWFkb25seSBzZXR1cDogU3RlcFtdO1xuICBwdWJsaWMgcmVhZG9ubHkgdGltZW91dDogbnVtYmVyO1xuICBwdWJsaWMgcmVhZG9ubHkgcG9zdENoZWNrU2xlZXA6IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IHBvc3ROZXh0U2xlZXA6IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IHBvc3RMb2dpblNsZWVwOiBudW1iZXI7XG4gIHB1YmxpYyByZWFkb25seSByZXdyaXRlOiAodXJsOiBzdHJpbmcsIHR5cGU6IHN0cmluZywgc291cmNlOiBCdWZmZXIsIGZpeGVzOiBudW1iZXJbXSkgPT4gQnVmZmVyO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IocmF3OiBJQkxlYWtDb25maWcsIHByaXZhdGUgcmVhZG9ubHkgX2NvbmZpZ1NvdXJjZTogc3RyaW5nKSB7XG4gICAgdGhpcy51cmwgPSByYXcudXJsO1xuICAgIHRoaXMubG9vcCA9IHJhdy5sb29wO1xuICAgIHRoaXMuaXRlcmF0aW9ucyA9IHJhdy5pdGVyYXRpb25zO1xuICAgIHRoaXMucmFua2luZ0V2YWx1YXRpb25JdGVyYXRpb25zID0gcmF3LnJhbmtpbmdFdmFsdWF0aW9uSXRlcmF0aW9ucztcbiAgICB0aGlzLnJhbmtpbmdFdmFsdWF0aW9uUnVucyA9IHJhdy5yYW5raW5nRXZhbHVhdGlvblJ1bnM7XG4gICAgdGhpcy5maXhlZExlYWtzID0gcmF3LmZpeGVkTGVha3M7XG4gICAgdGhpcy5maXhNYXAgPSByYXcuZml4TWFwO1xuICAgIHRoaXMubG9naW4gPSByYXcubG9naW47XG4gICAgdGhpcy5zZXR1cCA9IHJhdy5zZXR1cDtcbiAgICB0aGlzLnRpbWVvdXQgPSByYXcudGltZW91dDtcbiAgICB0aGlzLnJld3JpdGUgPSByYXcucmV3cml0ZTtcbiAgICB0aGlzLnBvc3RDaGVja1NsZWVwID0gcmF3LnBvc3RDaGVja1NsZWVwO1xuICAgIHRoaXMucG9zdE5leHRTbGVlcCA9IHJhdy5wb3N0TmV4dFNsZWVwO1xuICAgIHRoaXMucG9zdExvZ2luU2xlZXAgPSByYXcucG9zdExvZ2luU2xlZXA7XG4gIH1cblxuICBwdWJsaWMgZ2V0QnJvd3NlckluamVjdGlvbigpOiBzdHJpbmcge1xuICAgIC8vIENvbW1vbkpTIGVtdWxhdGlvblxuICAgIHJldHVybiBgKGZ1bmN0aW9uKCkge1xuICB2YXIgbW9kdWxlID0geyBleHBvcnRzOiB7fSB9O1xuICB2YXIgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzO1xuICAke3RoaXMuX2NvbmZpZ1NvdXJjZX1cbiAgd2luZG93LkJMZWFrQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgJHtERUZBVUxUX0NPTkZJR19TVFJJTkd9LCBtb2R1bGUuZXhwb3J0cyA/IG1vZHVsZS5leHBvcnRzIDogZXhwb3J0cyk7XG59KSgpO2A7XG4gIH1cbn1cbiJdfQ==